<h1 id="hooks">Hooks</h1>

<h2 id="introduction">Introduction</h2>

<p>Cordova Hooks represent special scripts which could be added by application and
plugin developers or even by your own build system  to customize cordova commands.</p>

<p>Cordova hooks allow you to perform special activities around cordova commands. For example,
you may have a custom tool that checks for code formatting in your javascript file. And, you
would like to run this tool before every build. In such a case, you could use a
‘before_build’ hook and instruct the cordova run time to run the custom tool to be invoked
before every build.</p>

<p>Hooks might be related to your application activities such as <code class="language-plaintext highlighter-rouge">before_build</code>,
<code class="language-plaintext highlighter-rouge">after_build</code>, etc. Or, they might be related to the plugins of your application. For example,
hooks such as <code class="language-plaintext highlighter-rouge">before_plugin_add</code>, <code class="language-plaintext highlighter-rouge">after_plugin_add</code>, etc applies to plugin related
activities. These hooks can be associated with all plugins within your application or
be specific to only one plugin.</p>

<p>Cordova supports the following hook types:</p>

<!-- START HTML -->

<table class="hooks" width="100%">
    <col width="20%" />
    <col width="30%" />
    <col width="50%" />
    <thead>
        <tr>
            <th>Hook Type</th>
            <th>Associated Cordova Commands</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th data-col="beforeplatformadd">before_platform_add</th>
            <td data-col="code" rowspan="2"><code>cordova platform add</code></td>
            <td rowspan="2" class="description" data-col="description">To be executed before and after adding a platform.</td>
        </tr>
        <tr>
            <th data-col="afterplatformadd">after_platform_add</th>
        </tr>
        <tr>
            <th data-col="beforeplatformrm">before_platform_rm</th>
            <td data-col="code" rowspan="2"><code>cordova platform rm</code></td>
            <td rowspan="2" class="description" data-col="description">To be executed before and after removing a platform.</td>
        </tr>
        <tr>
            <th data-col="afterplatformrm">after_platform_rm</th>
        </tr>
        <tr>
            <th data-col="beforeplatformls">before_platform_ls</th>
            <td data-col="code" rowspan="2"><code>cordova platform ls</code></td>
            <td rowspan="2" class="description" data-col="description">To be executed before and after listing the installed and available platforms.</td>
        </tr>
        <tr>
            <th data-col="afterplatformls">after_platform_ls</th>
        </tr>
        <tr>
            <th data-col="beforeprepare">before_prepare</th>
            <td data-col="code" rowspan="2"><code>cordova prepare</code><br /><code>cordova platform add</code><br /><code>cordova build</code><br /><code>cordova run</code></td>
            <td rowspan="2" data-col="description">To be executed before and after preparing your application.</td>
        </tr>
        <tr>
            <th data-col="afterprepare">after_prepare</th>
        </tr>
        <tr>
            <th data-col="beforecompile">before_compile</th>
            <td data-col="code" rowspan="2"><code>cordova compile</code><br /><code>cordova build</code></td>
            <td rowspan="2" data-col="description">To be executed before and after compiling your application.</td>
        </tr>
        <tr>
            <th data-col="aftercompile">after_compile</th>
        </tr>
        <tr>
            <th data-col="beforedeploy">before_deploy</th>
            <td data-col="code"><code>cordova emulate</code><br /><code>cordova run</code></td>
            <td data-col="description">To be executed before deploying your application.</td>
        </tr>
        <tr>
            <th data-col="beforebuild">before_build</th>
            <td data-col="code" rowspan="2"><code>cordova build</code></td>
            <td rowspan="2" data-col="description">To be executed before and after building your application.</td>
        </tr>
        <tr>
            <th data-col="afterbuild">after_build</th>
        </tr>
        <tr>
            <th data-col="beforeemulate">before_emulate</th>
            <td data-col="code" rowspan="2"><code>cordova emulate</code></td>
            <td rowspan="2" data-col="description">To be executed before and after emulating your application.</td>
        </tr>
        <tr>
            <th data-col="afteremulate">after_emulate</th>
        </tr>
        <tr>
            <th data-col="beforerun">before_run</th>
            <td data-col="code" rowspan="2"><code>cordova run</code></td>
            <td rowspan="2" data-col="description">To be executed before and after running your application.</td>
        </tr>
        <tr>
            <th data-col="afterrun">after_run</th>
        </tr>
        <tr>
            <th data-col="beforeserve">before_serve</th>
            <td data-col="code" rowspan="2"><code>cordova serve</code></td>
            <td rowspan="2" data-col="description">To be executed before and after serving your application.</td>
        </tr>
        <tr>
            <th data-col="afterserve">after_serve</th>
        </tr>
        <tr>
            <th data-col="beforeclean">before_clean</th>
            <td data-col="code" rowspan="2"><code>cordova clean</code></td>
            <td rowspan="2" data-col="description">To be executed before and after cleaning your application.</td>
        </tr>
        <tr>
            <th data-col="afterclean">after_clean</th>
        </tr>
        <tr>
            <th data-col="beforepluginadd">before_plugin_add</th>
            <td data-col="code" rowspan="2"><code>cordova plugin add</code></td>
            <td rowspan="2" data-col="description">To be executed before and after adding a plugin.</td>
        </tr>
        <tr>
            <th data-col="afterpluginadd">after_plugin_add</th>
        </tr>
        <tr>
            <th data-col="beforepluginrm">before_plugin_rm</th>
            <td data-col="code" rowspan="2"><code>cordova plugin rm</code></td>
            <td rowspan="2" data-col="description">To be executed before and after removing a plugin.</td>
        </tr>
        <tr>
            <th data-col="afterpluginrm">after_plugin_rm</th>
        </tr>
        <tr>
            <th data-col="beforepluginls">before_plugin_ls</th>
            <td data-col="code" rowspan="2"><code>cordova plugin ls</code></td>
            <td rowspan="2" data-col="description">To be executed before and after listing the plugins in your application.</td>
        </tr>
        <tr>
            <th data-col="afterpluginls">after_plugin_ls</th>
        </tr>
        <tr>
            <th data-col="beforeplugininstall">before_plugin_install</th>
            <td data-col="code" rowspan="2"><code>cordova plugin add</code></td>
            <td rowspan="2" data-col="description">To be executed before and after installing a plugin (to the platforms). Plugin hooks in plugin.xml are executed for a plugin being installed only</td>
        </tr>
        <tr>
            <th data-col="afterplugininstall">after_plugin_install</th>
        </tr>
        <tr>
            <th data-col="beforepluginuninstall">before_plugin_uninstall</th>
            <td data-col="code" rowspan="2"><code>cordova plugin rm</code></td>
            <td data-col="description">To be executed before uninstalling a plugin (from the platforms).Plugin hooks in plugin.xml are executed for a plugin being installed only</td>
        </tr>
    </tbody>
</table>

<!-- END HTML -->

<h2 id="ways-to-define-hooks">Ways to define hooks</h2>

<h3 id="configxml">Config.xml</h3>

<p>Hooks could be defined in project’s <code class="language-plaintext highlighter-rouge">config.xml</code> using <code class="language-plaintext highlighter-rouge">&lt;hook&gt;</code> elements, for example:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/appBeforeBuild.bat"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/appBeforeBuild.js"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/appBeforePluginInstall.js"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;platform</span> <span class="na">name=</span><span class="s">"android"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/android/appAndroidBeforeBuild.bat"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/android/appAndroidBeforeBuild.js"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/android/appAndroidBeforePluginInstall.js"</span> <span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/platform&gt;</span>

<span class="nt">&lt;platform</span> <span class="na">name=</span><span class="s">"windows"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/windows/appWinBeforeBuild.bat"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/windows/appWinBeforeBuild.js"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/windows/appWinBeforePluginInstall.js"</span> <span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/platform&gt;</span>
</code></pre></div></div>

<h3 id="plugin-hooks-pluginxml">Plugin hooks (plugin.xml)</h3>

<p>As a plugin developer you can define hook scripts using <code class="language-plaintext highlighter-rouge">&lt;hook&gt;</code> elements in a <code class="language-plaintext highlighter-rouge">plugin.xml</code> like that:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/beforeInstall.js"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"after_build"</span> <span class="na">src=</span><span class="s">"scripts/afterBuild.js"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;platform</span> <span class="na">name=</span><span class="s">"android"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_plugin_install"</span> <span class="na">src=</span><span class="s">"scripts/androidBeforeInstall.js"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"before_build"</span> <span class="na">src=</span><span class="s">"scripts/androidBeforeBuild.js"</span> <span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/platform&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">before_plugin_install</code>, <code class="language-plaintext highlighter-rouge">after_plugin_install</code>, <code class="language-plaintext highlighter-rouge">before_plugin_uninstall</code> plugin hooks will be fired
exclusively for the plugin being installed/uninstalled.</p>

<h3 id="order-of-hooks-execution">Order of Hooks execution</h3>

<h4 id="based-on-hooks-definition">Based on Hooks Definition</h4>

<p>Hook scripts for one given hook run serially in the order of appearance in their file with application hooks from <code class="language-plaintext highlighter-rouge">config.xml</code> running before plugin hooks from <code class="language-plaintext highlighter-rouge">plugins/.../plugin.xml</code>.</p>

<h4 id="based-on-the-internal-order-of-execution">Based on the Internal order of execution</h4>

<p>The internal order of execution of hooks is fixed.</p>

<h5 id="example-1-cordova-platform-add">Example 1 (cordova platform add)</h5>
<p>If there are hooks associated with <code class="language-plaintext highlighter-rouge">before_platform_add</code>, <code class="language-plaintext highlighter-rouge">after_platform_add</code>, <code class="language-plaintext highlighter-rouge">before_prepare</code>, <code class="language-plaintext highlighter-rouge">after_prepare</code>,
<code class="language-plaintext highlighter-rouge">before_plugin_install</code> and <code class="language-plaintext highlighter-rouge">after_plugin_install</code> (and assuming you have one plugin installed on your project),
adding a new platform will execute the hooks in the following order:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>before_platform_add
    before_prepare
    after_prepare
    before_plugin_install
    after_plugin_install
after_platform_add
</code></pre></div></div>

<h5 id="example-2-cordova-build">Example 2 (cordova build)</h5>
<p>If there are hooks associated with <code class="language-plaintext highlighter-rouge">before_prepare</code>, <code class="language-plaintext highlighter-rouge">after_prepare</code>, <code class="language-plaintext highlighter-rouge">before_compile</code>, <code class="language-plaintext highlighter-rouge">after_compile</code>, <code class="language-plaintext highlighter-rouge">before_build</code>
and <code class="language-plaintext highlighter-rouge">after_build</code> - running a build command will execute the hooks in the following order:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>before_build
    before_prepare
    after_prepare
    before_compile
    after_compile
after_build
</code></pre></div></div>

<h2 id="script-interface">Script Interface</h2>

<h3 id="javascript">Javascript</h3>

<p>If you are writing hooks using Node.js you should use the following module definition:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here is an example that showcases the contents of the <code class="language-plaintext highlighter-rouge">context</code> object:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="c1">// The type of hook being run</span>
  <span class="nl">hook</span><span class="p">:</span> <span class="dl">'</span><span class="s1">before_plugin_install</span><span class="dl">'</span><span class="p">,</span>

  <span class="c1">// Absolute path to the hook script that is currently executing</span>
  <span class="nx">scriptLocation</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/foo/scripts/appBeforePluginInstall.js</span><span class="dl">'</span><span class="p">,</span>

  <span class="c1">// The CLI command that lead to this hook being executed</span>
  <span class="nx">cmdLine</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cordova plugin add plugin-withhooks</span><span class="dl">'</span><span class="p">,</span>

  <span class="c1">// The options associated with the current operation.</span>
  <span class="c1">// WARNING: The contents of this object vary among the different</span>
  <span class="c1">// operations and are currently not documented anywhere.</span>
  <span class="nx">opts</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">projectRoot</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/foo</span><span class="dl">'</span><span class="p">,</span>

    <span class="nx">cordova</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">platforms</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">android</span><span class="dl">'</span><span class="p">],</span>
      <span class="nx">plugins</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">plugin-withhooks</span><span class="dl">'</span><span class="p">],</span>
      <span class="nx">version</span><span class="p">:</span> <span class="dl">'</span><span class="s1">0.21.7-dev</span><span class="dl">'</span>
    <span class="p">},</span>

    <span class="c1">// Information about the plugin currently operated on.</span>
    <span class="c1">// This object will only be passed to plugin hooks scripts.</span>
    <span class="nx">plugin</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">plugin-withhooks</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">pluginInfo</span><span class="p">:</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">},</span>
      <span class="nx">platform</span><span class="p">:</span> <span class="dl">'</span><span class="s1">android</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">dir</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/foo/plugins/plugin-withhooks</span><span class="dl">'</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="c1">// A reference to Cordova's API</span>
  <span class="nx">cordova</span><span class="p">:</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>You can also require additional Cordova modules in your script using <code class="language-plaintext highlighter-rouge">context.requireCordovaModule</code> in the following way:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">cordovaCommon</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">requireCordovaModule</span><span class="p">(</span><span class="dl">'</span><span class="s1">cordova-common</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>You can make your scripts asynchronous using Promises.
Here is an example that just waits for a second and then prints the amount of milliseconds spent waiting:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">context</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">),</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">msWaited</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">context</span><span class="p">.</span><span class="nx">scriptLocation</span><span class="p">}</span><span class="s2"> waited </span><span class="p">${</span><span class="nx">msWaited</span><span class="p">}</span><span class="s2"> ms`</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="non-javascript">Non-javascript</h3>

<p>Non-javascript scripts are run via Node child_process spawn from the project’s root directory and have the root directory passed as the first argument. All other options are passed to the script using environment variables:</p>

<table>
  <thead>
    <tr>
      <th>Environment Variable Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CORDOVA_VERSION</td>
      <td>The version of the Cordova-CLI.</td>
    </tr>
    <tr>
      <td>CORDOVA_PLATFORMS</td>
      <td>Comma separated list of platforms that the command applies to (e.g: android, ios).</td>
    </tr>
    <tr>
      <td>CORDOVA_PLUGINS</td>
      <td>Comma separated list of plugin IDs that the command applies to (e.g: cordova-plugin-file-transfer, cordova-plugin-file).</td>
    </tr>
    <tr>
      <td>CORDOVA_HOOK</td>
      <td>Path to the hook that is being executed.</td>
    </tr>
    <tr>
      <td>CORDOVA_CMDLINE</td>
      <td>The exact command-line arguments passed to cordova (e.g: cordova run ios –emulate).</td>
    </tr>
  </tbody>
</table>

<p>If a script returns a non-zero exit code, then the parent cordova command will be aborted.</p>

<blockquote>
  <p><strong>Note</strong>: we highly recommend writing your hooks using Node.js so that they are cross-platform, see <a href="#link-javascript">Javascript</a> section above.</p>
</blockquote>

<h4 id="windows-quirks">Windows Quirks</h4>

<p>If you are working on Windows, and your hook scripts aren’t <code class="language-plaintext highlighter-rouge">*.bat</code> files, Cordova CLI will expect a shebang line as the first line of the script. This way it knows the interpreter it needs to use to launch the script. A shebang line for a Python script could look like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/usr/bin/env python
</code></pre></div></div>

<h2 id="sample-usage">Sample Usage</h2>

<p>This sample demonstrates Cordova hooks usage to trace to the console output the
size of generated .apk file for Android platform.</p>

<p>Create blank Cordova app and add the following definition to <code class="language-plaintext highlighter-rouge">config.xml</code> to
tell Cordova to run <code class="language-plaintext highlighter-rouge">afterBuild.js</code> script after each platform build.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;hook</span> <span class="na">type=</span><span class="s">"after_build"</span> <span class="na">src=</span><span class="s">"scripts/afterBuild.js"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>Create <code class="language-plaintext highlighter-rouge">scripts/afterBuild.js</code> file and add the following implementation.
We use async version of <code class="language-plaintext highlighter-rouge">fs.stat</code> method to demonstrate how async functions
can be used in hooks.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">util</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">stat</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">promisify</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Make sure android platform is part of build</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">platforms</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">android</span><span class="dl">'</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">platformRoot</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">projectRoot</span><span class="p">,</span> <span class="dl">'</span><span class="s1">platforms/android</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">apkFileLocation</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">platformRoot</span><span class="p">,</span> <span class="dl">'</span><span class="s1">build/outputs/apk/android-debug.apk</span><span class="dl">'</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">stat</span><span class="p">(</span><span class="nx">apkFileLocation</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">stats</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Size of </span><span class="p">${</span><span class="nx">apkFileLocation</span><span class="p">}</span><span class="s2"> is </span><span class="p">${</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span><span class="p">}</span><span class="s2"> bytes`</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Parameter <code class="language-plaintext highlighter-rouge">ctx</code> in example above is passed by Cordova and represents execution
context such as script full path, target platform, command-line arguments, etc and
also exposes additional helper functionality. See <code class="language-plaintext highlighter-rouge">Script Interface</code> section above
for more details.</p>

<p>You can now add android platform and execute build.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cordova platform add android
..
cordova build
..
Size of path\to\app\platforms\android\build\outputs\apk\android-debug.apk is 1821193 bytes
</code></pre></div></div>

<p>More good usage examples could be found in <a href="http://devgirl.org/2013/11/12/three-hooks-your-cordovaphonegap-project-needs/">Three Hooks Your Cordova Phone Gap Project needs</a></p>

